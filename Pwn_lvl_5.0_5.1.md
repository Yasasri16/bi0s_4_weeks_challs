I got the code.. It takes some input and stores it in a var "buf".. It prints our initial input in hexa decimal format.. Then it says our data got mangled.. The logic behind the mangling is that each character gets XOR with a particular number.. The expected result is this modified input.. So we need to do reversing..I got the flag using the special property of XOR..

Same with the level 5.1
